include fsfx/common.inc

vec4 fsfx()
{
	vec2 colormapSize = textureSize(colormap, 0);
	vec2 colormapSizeRcp = 1.f / colormapSize;
	
	vec2 sampleCoord = texcoord;
	
	sampleCoord -= vec2(0.5);
	sampleCoord *= colormapSize;
	if (param1 > 0.0)
		sampleCoord.x = round(sampleCoord.x / param1) * param1;
	if (param2 > 0.0)
		sampleCoord.y = round(sampleCoord.y / param2) * param2;
	sampleCoord *= colormapSizeRcp;
	sampleCoord += vec2(0.5);
	
	vec4 color = texture(colormap, sampleCoord);
	
	return color;
}
