// todo : fix same uniform block name as variable name
//        GLSL doesn't allow this. make a change to shader builder ?

uniform vec4 lightParams[64*4] buffer lightParamsBuffer;
uniform float numLights;

#define kLightType_Point 0
#define kLightType_Spot 1
#define kLightType_Directional 2

struct LightParams
{
	vec3 position;
	float type;

	vec3 direction;
	float reserved;

	vec3 color;
	float reserved2;

	float attenuationBegin;
	float attenuationEnd;

	float spotAngleAlpha;

	float userData;
};

LightParams decodeLightParams(vec4 params1, vec4 params2, vec4 params3, vec4 params4)
{
	LightParams result;

	result.position = params1.xyz;
	result.type = params1.w;
	
	result.direction = params2.xyz;
	result.reserved = params2.w;

	result.color = params3.xyz;
	result.reserved2 = params3.w;

	result.attenuationBegin = params4.x;
	result.attenuationEnd = params4.y;
	result.spotAngleAlpha = params4.z;

	result.userData = params4.w;

	return result;
}

LightParams lookupLightParams(int id)
{
	vec4 params1 = lightParams[id * 4 + 0];
	vec4 params2 = lightParams[id * 4 + 1];
	vec4 params3 = lightParams[id * 4 + 2];
	vec4 params4 = lightParams[id * 4 + 3];

	return decodeLightParams(
		params1,
		params2,
		params3,
		params4);
}
